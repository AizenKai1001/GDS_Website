<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Week 2 Gun Program</title>
    <!--PUT YOUR NAME IN THE META TAG FOR AUTHOR-->
    <meta name="author" content="Jancarlos Espinal">
    <!--xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx-->
    <meta name="description" content="Small programming assignment using events, variables, functions and conditional logic">

</head>
<body>
    <!--Main content of the site-->
    <div>
        <!--Control and output for the "shoot" functionality-->
        <div>
            <button id="trigger-button"><img src="../images/homework/revolver.jpg"></button>
            <span id="trigger-display"></span>
        </div>
        <!--Control and output for the "reload" functionality-->
        <div>
            <button id="reload-button"><img src="../images/homework/reload.png" style="width: 60px; height: 60px;"></button>
            <span id="reload-display"></span>
        </div>
    </div>
    <script>
        /*-----------------------------------
        Project Description: 
        In this assignment you will write the code to make the following happen:
        1. Make the reload button clickable
        2. When it is clicked your inventory will lose ammo
        3. When it is clicked your gun will gain ammo
        4. The inventory should never drop below 0
        5. CHALLENGE: Can you make the correct number of ammo move from the inventory to the gun? For example if the ammo is at 4 and the max is 6 can you make only 2 subtract from inventory and add to ammo?
        6. Display the resulting numbers in the span tags.
        ------------------------------------*/

        //stores the <button> and <span> elements in variables by selecting the the elements by their id attribute. The # is used when referencing an element's id
        var triggerButton = document.querySelector(`#trigger-button`)
        var triggerDisplay = document.querySelector(`#trigger-display`)
        var reloadButton = document.querySelector(`#reload-button`)
        var reloadDisplay = document.querySelector(`#reload-display`)

        //Variables used to set up the gun and inventory values
        //Maximum amount of ammo the weapon can hold
        var max = 6
        //Amount of ammo currently loaded into the weapon
        var current = max
        //Amount of ammo in the character's inventory
        var inventory = 10

        //Changes the words between <span> and </span> for each span element
        triggerDisplay.innerHTML = `AMMO: ${current}`
        reloadDisplay.innerHTML = `INVENTORY: ${inventory}`

        /*
        Adds functionality to the button so that when it is clicked it will execute the shoot function
        */
        triggerButton.addEventListener(`click`, shoot)

        /*
        When the shoot function is executed by a user/player clicking the trigger button:
         1. currentAmmo is subtracted by one
         2. if currentAmmo is less than zero, it is set back to zero
         3. The triggerDisplay text is updated to show the latest value for currentAmmo
         NOTE: the "event" placeholder variable in the parenthesis needs to be there for a function to work when it is executed by a  click or any other type of event listener.
        */
        function shoot(event)
        {
            current--
            if(current<0)
            {
                current = 0;
                new Audio('../sounds/fail-shoot.mp3').play(); //plays the empty sound
            }
            triggerDisplay.innerHTML = `AMMO: ${current}`
            if(current > 0){
                new Audio('../sounds/shoot.mp3').play(); //plays the shoot sound
            }
  
        }

        triggerButton.addEventListener("click", shoot)


        /*------------------INSTRUCTIONS------------------
        Using the code above as a guide, try to make the reload button work below this comment.
        1. Add an event listener to it that calls a function when clicked
        2. Within the function do the following
            a. Subtract ammo from the inventory
            b. Add ammo to the currentAmmo
            d. Stop inventory from going into the negative numbers
            c. Display the result on in the reloadDisplay by changing it's innerHTML
            d. EXTRA CHALLENGE: Figure out how much ammo to load. This will require some math based on how much ammo has been expended and the maximum amount ammo the weapon can hold
        --------------------------------------------------*/
            function reload(){
            // Setting the needed amount to the max minus the current ammo
            var neededAmmo = max - current;
            //console.log(neededAmmo);

            // Setting the available ammo to the minimum between the needed ammo and inventory
            var availableAmmo = Math.min(neededAmmo, inventory);
            //console.log(availableAmmo);

            //Add the available ammo to current and subtract it from inventory
            current += availableAmmo;
            inventory -= availableAmmo;
            //console.log("Adding available ammo:"+current, "to current ammo, then subtracting from inventory:"+inventory);

            if (inventory <= 0) {
                inventory = 0; // Prevent inventory from going negative
                reloadDisplay.innerHTML = `INVENTORY: NO AMMO CAN'T RELOAD`;
            }else{                                                      // Update the inventory display
                reloadDisplay.innerHTML = `INVENTORY: ${inventory}`;
                new Audio('../sounds/reload.mp3').play(); //plays the reload sound
            }



            // Update the ammo display
            triggerDisplay.innerHTML = `AMMO: ${current}`;
        }

        var reloading = false;


        reloadButton.addEventListener("click", function(){
            if(reloading){

            }else{  //prevents spamming the button
                reload("click", reload) 

                console.log("Reload button clicked");
                reloadButton.classList.add("active"); //keeps the button clicked 
                reloading = true;

                setTimeout(function(){
                reloadButton.classList.remove("active");
                reloading = false;
                }, 500); // how long the button stays clicked in milliseconds
            } 
            

        });
    </script>

    <style>
        #trigger-button{
            background-color: transparent;
            border: none;
        }
        #trigger-button:hover{
            cursor: pointer;
            background-color: #0000000a;
            border-radius: 70px;
            transform: translateY(-2px);
            transition: .2s ease-out;
        }
        #trigger-button:active{
            transform: translateY(2px);
            transform: rotate(353deg);
        }



        #reload-button{
            background-color: transparent;
            border: none;
            
        }
        #reload-button:hover{
            cursor: pointer;
            background-color: #0000000a;
            border-radius: 70px;
            transform: translateY(-2px);
            transition: .2s ease-out;
        }
        #reload-button.active{
            animation: spin 0.5s linear;
        }

        @keyframes spin {
            0% { transform: rotate(0deg);}
            100% { transform: rotate(360deg);}
        }

    </style>
</body>
</html>